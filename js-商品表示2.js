function but1() {
    document.getElementById("but1").style.backgroundColor = "#C6AC8F";
    document.getElementById("but1").style.border = "none";
    document.getElementById("but2").style.backgroundColor = "white";
    document.getElementById("but2").style.borderStyle = "solid";
    document.getElementById("but2").style.borderWidth = "1px";
    document.getElementById("but2").style.borderColor = "#3A1F00";
    document.getElementById("but3").style.backgroundColor = "white";
    document.getElementById("but3").style.borderStyle = "solid";
    document.getElementById("but3").style.borderWidth = "1px";
    document.getElementById("but3").style.borderColor = "#3A1F00";
    document.getElementById("but4").style.backgroundColor = "white";
    document.getElementById("but4").style.borderStyle = "solid";
    document.getElementById("but4").style.borderWidth = "1px";
    document.getElementById("but4").style.borderColor = "#3A1F00";
    document.getElementById("but5").style.backgroundColor = "white";
    document.getElementById("but5").style.borderStyle = "solid";
    document.getElementById("but5").style.borderWidth = "1px";
    document.getElementById("but5").style.borderColor = "#3A1F00";
    document.getElementById("but6").style.backgroundColor = "white";
    document.getElementById("but6").style.borderStyle = "solid";
    document.getElementById("but6").style.borderWidth = "1px";
    document.getElementById("but6").style.borderColor = "#3A1F00";
    document.getElementById("button11").style.opacity = "1";
    document.getElementById("button11").style.display = "block";
    document.getElementById("button22").style.opacity = "0";
    document.getElementById("button22").style.display = "none";
    document.getElementById("button33").style.opacity = "0";
    document.getElementById("button33").style.display = "none";
    document.getElementById("button44").style.opacity = "0";
    document.getElementById("button44").style.display = "none";
    document.getElementById("button55").style.opacity = "0";
    document.getElementById("button55").style.display = "none";
    document.getElementById("button66").style.opacity = "0";
    document.getElementById("button66").style.display = "none";
}
function but2() {
    document.getElementById("but2").style.backgroundColor = "#C6AC8F";
    document.getElementById("but2").style.border = "none";
    document.getElementById("but1").style.backgroundColor = "white";
    document.getElementById("but1").style.borderStyle = "solid";
    document.getElementById("but1").style.borderWidth = "1px";
    document.getElementById("but1").style.borderColor = "#3A1F00";
    document.getElementById("but3").style.backgroundColor = "white";
    document.getElementById("but3").style.borderStyle = "solid";
    document.getElementById("but3").style.borderWidth = "1px";
    document.getElementById("but3").style.borderColor = "#3A1F00";
    document.getElementById("but4").style.backgroundColor = "white";
    document.getElementById("but4").style.borderStyle = "solid";
    document.getElementById("but4").style.borderWidth = "1px";
    document.getElementById("but4").style.borderColor = "#3A1F00";
    document.getElementById("but5").style.backgroundColor = "white";
    document.getElementById("but5").style.borderStyle = "solid";
    document.getElementById("but5").style.borderWidth = "1px";
    document.getElementById("but5").style.borderColor = "#3A1F00";
    document.getElementById("but6").style.backgroundColor = "white";
    document.getElementById("but6").style.borderStyle = "solid";
    document.getElementById("but6").style.borderWidth = "1px";
    document.getElementById("but6").style.borderColor = "#3A1F00";
    document.getElementById("button11").style.opacity = "0";
    document.getElementById("button11").style.display = "none";
    document.getElementById("button22").style.opacity = "1";
    document.getElementById("button22").style.display = "block";
    document.getElementById("button33").style.opacity = "0";
    document.getElementById("button33").style.display = "none";
    document.getElementById("button44").style.opacity = "0";
    document.getElementById("button44").style.display = "none";
    document.getElementById("button55").style.opacity = "0";
    document.getElementById("button55").style.display = "none";
    document.getElementById("button66").style.opacity = "0";
    document.getElementById("button66").style.display = "none";
}
function but3() {
    document.getElementById("but1").style.backgroundColor = "white";
    document.getElementById("but1").style.borderStyle = "solid";
    document.getElementById("but1").style.borderWidth = "1px";
    document.getElementById("but1").style.borderColor = "#3A1F00";
    document.getElementById("but2").style.backgroundColor = "white";
    document.getElementById("but2").style.borderStyle = "solid";
    document.getElementById("but2").style.borderWidth = "1px";
    document.getElementById("but2").style.borderColor = "#3A1F00";
    document.getElementById("but3").style.backgroundColor = "#C6AC8F";
    document.getElementById("but3").style.border = "none";
    document.getElementById("but4").style.backgroundColor = "white";
    document.getElementById("but4").style.borderStyle = "solid";
    document.getElementById("but4").style.borderWidth = "1px";
    document.getElementById("but4").style.borderColor = "#3A1F00";
    document.getElementById("but5").style.backgroundColor = "white";
    document.getElementById("but5").style.borderStyle = "solid";
    document.getElementById("but5").style.borderWidth = "1px";
    document.getElementById("but5").style.borderColor = "#3A1F00";
    document.getElementById("but6").style.backgroundColor = "white";
    document.getElementById("but6").style.borderStyle = "solid";
    document.getElementById("but6").style.borderWidth = "1px";
    document.getElementById("but6").style.borderColor = "#3A1F00";
    document.getElementById("button11").style.opacity = "0";
    document.getElementById("button11").style.display = "none";
    document.getElementById("button22").style.opacity = "0";
    document.getElementById("button22").style.display = "none";
    document.getElementById("button33").style.opacity = "1";
    document.getElementById("button33").style.display = "block";
    document.getElementById("button44").style.opacity = "0";
    document.getElementById("button44").style.display = "none";
    document.getElementById("button55").style.opacity = "0";
    document.getElementById("button55").style.display = "none";
    document.getElementById("button66").style.opacity = "0";
    document.getElementById("button66").style.display = "none";
}
function but4() {
    document.getElementById("but1").style.backgroundColor = "white";
    document.getElementById("but1").style.borderStyle = "solid";
    document.getElementById("but1").style.borderWidth = "1px";
    document.getElementById("but1").style.borderColor = "#3A1F00";
    document.getElementById("but2").style.backgroundColor = "white";
    document.getElementById("but2").style.borderStyle = "solid";
    document.getElementById("but2").style.borderWidth = "1px";
    document.getElementById("but2").style.borderColor = "#3A1F00";
    document.getElementById("but3").style.backgroundColor = "white";
    document.getElementById("but3").style.borderStyle = "solid";
    document.getElementById("but3").style.borderWidth = "1px";
    document.getElementById("but3").style.borderColor = "#3A1F00";
    document.getElementById("but4").style.backgroundColor = "#C6AC8F";
    document.getElementById("but4").style.border = "none";
    document.getElementById("but5").style.backgroundColor = "white";
    document.getElementById("but5").style.borderStyle = "solid";
    document.getElementById("but5").style.borderWidth = "1px";
    document.getElementById("but5").style.borderColor = "#3A1F00";
    document.getElementById("but6").style.backgroundColor = "white";
    document.getElementById("but6").style.borderStyle = "solid";
    document.getElementById("but6").style.borderWidth = "1px";
    document.getElementById("but6").style.borderColor = "#3A1F00";
    document.getElementById("button11").style.opacity = "0";
    document.getElementById("button11").style.display = "none";
    document.getElementById("button22").style.opacity = "0";
    document.getElementById("button22").style.display = "none";
    document.getElementById("button33").style.opacity = "0";
    document.getElementById("button33").style.display = "none";
    document.getElementById("button44").style.opacity = "1";
    document.getElementById("button44").style.display = "block";
    document.getElementById("button55").style.opacity = "0";
    document.getElementById("button55").style.display = "none";
    document.getElementById("button66").style.opacity = "0";
    document.getElementById("button66").style.display = "none";
}
function but5() {
    document.getElementById("but1").style.backgroundColor = "white";
    document.getElementById("but1").style.borderStyle = "solid";
    document.getElementById("but1").style.borderWidth = "1px";
    document.getElementById("but1").style.borderColor = "#3A1F00";
    document.getElementById("but2").style.backgroundColor = "white";
    document.getElementById("but2").style.borderStyle = "solid";
    document.getElementById("but2").style.borderWidth = "1px";
    document.getElementById("but2").style.borderColor = "#3A1F00";
    document.getElementById("but3").style.backgroundColor = "white";
    document.getElementById("but3").style.borderStyle = "solid";
    document.getElementById("but3").style.borderWidth = "1px";
    document.getElementById("but3").style.borderColor = "#3A1F00";
    document.getElementById("but4").style.backgroundColor = "white";
    document.getElementById("but4").style.borderStyle = "solid";
    document.getElementById("but4").style.borderWidth = "1px";
    document.getElementById("but4").style.borderColor = "#3A1F00";
    document.getElementById("but5").style.backgroundColor = "#C6AC8F";
    document.getElementById("but5").style.border = "none";
    document.getElementById("but6").style.backgroundColor = "white";
    document.getElementById("but6").style.borderStyle = "solid";
    document.getElementById("but6").style.borderWidth = "1px";
    document.getElementById("but6").style.borderColor = "#3A1F00";
    document.getElementById("button11").style.opacity = "0";
    document.getElementById("button11").style.display = "none";
    document.getElementById("button22").style.opacity = "0";
    document.getElementById("button22").style.display = "none";
    document.getElementById("button33").style.opacity = "0";
    document.getElementById("button33").style.display = "none";
    document.getElementById("button44").style.opacity = "0";
    document.getElementById("button44").style.display = "none";
    document.getElementById("button55").style.opacity = "1";
    document.getElementById("button55").style.display = "block";
    document.getElementById("button66").style.opacity = "0";
    document.getElementById("button66").style.display = "none";
}
function but6() {
    document.getElementById("but1").style.backgroundColor = "white";
    document.getElementById("but1").style.borderStyle = "solid";
    document.getElementById("but1").style.borderWidth = "1px";
    document.getElementById("but1").style.borderColor = "#3A1F00";
    document.getElementById("but2").style.backgroundColor = "white";
    document.getElementById("but2").style.borderStyle = "solid";
    document.getElementById("but2").style.borderWidth = "1px";
    document.getElementById("but2").style.borderColor = "#3A1F00";
    document.getElementById("but3").style.backgroundColor = "white";
    document.getElementById("but3").style.borderStyle = "solid";
    document.getElementById("but3").style.borderWidth = "1px";
    document.getElementById("but3").style.borderColor = "#3A1F00";
    document.getElementById("but4").style.backgroundColor = "white";
    document.getElementById("but4").style.borderStyle = "solid";
    document.getElementById("but4").style.borderWidth = "1px";
    document.getElementById("but4").style.borderColor = "#3A1F00";
    document.getElementById("but5").style.backgroundColor = "white";
    document.getElementById("but5").style.borderStyle = "solid";
    document.getElementById("but5").style.borderWidth = "1px";
    document.getElementById("but5").style.borderColor = "#3A1F00";
    document.getElementById("but6").style.backgroundColor = "#C6AC8F";
    document.getElementById("but6").style.border = "none";
    document.getElementById("button11").style.opacity = "0";
    document.getElementById("button11").style.display = "none";
    document.getElementById("button22").style.opacity = "0";
    document.getElementById("button22").style.display = "none";
    document.getElementById("button33").style.opacity = "0";
    document.getElementById("button33").style.display = "none";
    document.getElementById("button44").style.opacity = "0";
    document.getElementById("button44").style.display = "none";
    document.getElementById("button55").style.opacity = "0";
    document.getElementById("button55").style.display = "none";
    document.getElementById("button66").style.opacity = "1";
    document.getElementById("button66").style.display = "block";
}

function start(){
    cd= document.cookie;
   // cd = 'branch=menu|; menumemo={"shop1":[0,22,38],"shop7":[14,36,52],"shop13":[4,26,42],"shop19":[1,23,39],"shop25":[1,23,39],"shop31":[1,23,39],"shop37":[1,23,39],"shop43":[1,23,39],"shop49":[1,23,39],"shop55":[23,39],"shop61":[23,39],"shop67":[23,39],"shop73":[23,39],"shop79":[23,39],"last":[79]}-; loginID=%E5%85%AB%E7%99%BE%E5%B1%8B!; pass=%E3%82%84%E3%81%BE%E3%81%8D?; shopnumber=85#; searchname=hello^;searchnum=85$';
console.log(cd);
        num1 = cd.indexOf("searchnum=");
        num2 = cd.indexOf("$");
        num3 = cd.indexOf("searchname=");
        num4 = cd.indexOf("^");
        sn = cd.substring(num1+10,num2);
        sn2 = decodeURI(cd.substring(num3+11,num4));
        console.log(sn+":"+sn2);
     document.getElementById("shopname").innerHTML = sn2;
     document.getElementById("shopname2").innerHTML = sn2;  
        sn = cd.substring(num1+10,num2);
        sn2 = decodeURI(cd.substring(num3+11,num4));
       console.log(sn+":"+sn2);
       setTimeout(startt,1000)
       }
       function startt(){
       console.log("loading start");
    url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
var data = [{
"name4":"店舗商品取得",
    "name5":sn,
"branch":"menudata"
}]
var params={
"method":"post",
"mode":"no-cors",
"Content-Type":"application/json",
"body":JSON.stringify(data)
}
fetch(url,params);
setTimeout(start1,3000);
}
function start1(){
console.log("getting start");
    url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
    fetch(url,{
        method:"GET",
        mode:"cors"
    })
    .then(response =>{
        if(response.ok){
            return response.json()
        }
    })
    .then(resJson =>{
jsondata = resJson;
        console.log("データ取得");
        start11();
    })
    .catch(error =>{
        alert("エラー");
    })
  
}
function start11(){
              data = jsondata.data;
        console.log("データ："+data);
      pre = data[0].pre;
        console.log(pre);
      city = data[0].city;
        console.log(city);
      city2 = data[0].city2;
        console.log(city2);
      adress = data[0].adress;
        console.log(adress);
      mailad = data[0].mailnum;
        console.log(mailad);
        phonead = data[0].phonenum;
        console.log(phonead);
      intro = data[0].intro;
        console.log(intro);
      time = data[0].time;
        console.log(time);
      adress = pre+city+city2+adress;
        console.log(adress);
      document.getElementById("adress").innerHTML = adress;
      document.getElementById("time").innerHTML = time;
      document.getElementById("phone").innerHTML = phonead;
      document.getElementById("introduce").innerHTML =intro ;
      document.getElementById("adress2").innerHTML = adress;
      document.getElementById("time2").innerHTML = time;
      document.getElementById("mailad2").innerHTML = mailad;
      document.getElementById("phone2").innerHTML = phonead;
                        console.log("データ取得入力完了");

}
function start2(){
  url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
var data = [{
"branch":"shopdata"
}]
var params={
"method":"post",
"mode":"no-cors",
"Content-Type":"application/json",
"body":JSON.stringify(data)
}
fetch(url,params);
console.log("firstsearch1 ok")
setTimeout(firstsearch2,2000);
}
firstdata1 = '';
firstdata2 = '';
success1 =  '';
success2 =  '';
function firstsearch2(){
  fetch('https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec',{
    method:"GET",
    mode:"cors"
  })
  .then(response =>{
    if(response.ok){
      return response.json()
    }
  })
  .then(resJson =>{
firstdata1 = resJson;
success1 = "ok";
console.log("firstsearch2 ok");
console.log("firstsearch finish");
console.log("firstmenusearch start>>");
firstmenu();

  })
.catch(error =>{
  num = 1;
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("ss").innerHTML = "search";
document.getElementById("s").style.backgroundColor ="#5A3A1A";

alert("通信失敗1")
})
}
function firstmenu(){
console.log("menusearch ok");
url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
var data = [{
"branch":"menu"
}]
var params={
"method":"post",
"mode":"no-cors",
"Content-Type":"application/json",
"body":JSON.stringify(data)
}
fetch(url,params);
console.log("firstmenusearch1 ok");
setTimeout(firstmenu2,2000);
}
function firstmenu2(){
console.log("menu2 ok");
fetch('https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec',{
    method:"GET",
    moe:"cors"
  })
  .then(response =>{
    if(response.ok){
      return response.json()
    }
  })
  .then(resJson =>{
    console.log("firstmenusearch2 ok");
firstdata2 = resJson;
console.log("firstdata 1/2 finish");
console.log("wait for instructions");
success2 = "ok";
  })
.catch(error =>{
  num = 1;  
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("ss").innerHTML = "search";
document.getElementById("s").style.backgroundColor ="#5A3A1A";

alert("通信失敗2")
})
}

  function pic(){
    if(a == 0){
      a = 1;
    document.getElementById("img").src="food.jpeg";
    setTimeout(pic,5000);
    }else{
      a = 0;
      document.getElementById("img").src="IMG_0064.JPG";
      setTimeout(pic,5000);
  }
}
function shop(){
  location.href="登録ページ.html";
}
document.getElementById("search").addEventListener('keyup',event =>{
if(event.keyCode == 13){
searching();
}
});

//取得時に全データ取得　始
firstdata1 = '';
firstdata2 = '';
success1 =  '';
success2 =  '';
request1 = '';
request2 = '';
request3 = '';
function firstsearch(){
  url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
var data = [{
"branch":"shopdata"
}]
var params={
"method":"post",
"mode":"no-cors",
"Content-Type":"application/json",
"body":JSON.stringify(data)
}
fetch(url,params);
console.log("firstsearch1 ok")
success1 = "o";
setTimeout(firstsearch2,2000);
}

function firstsearch2(){
  fetch('https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec',{
    method:"GET",
    moe:"cors"
  })
  .then(response =>{
    if(response.ok){
      return response.json()
    }
  })
  .then(resJson =>{
firstdata1 = resJson;
success1 = "ok";
console.log("firstsearch2 ok");
console.log("firstsearch finish");
console.log("firstmenusearch start>>");
if(request1 == "next"){
console.log("shopsearchへ優先処理")
shopsearch(resJson);
}else{
firstmenu();
}
  })
.catch(error =>{
  num = 1;
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("ss").innerHTML = "search";
document.getElementById("s").style.backgroundColor ="#5A3A1A";

alert("通信失敗1")
})
}
function firstmenu(){
if(request2 == "nomal"){
console.log("menusearch 通常処理　受付");
return;
}
console.log("firstmenusearch ok");
url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
var data = [{
"branch":"menu"
}]
var params={
"method":"post",
"mode":"no-cors",
"Content-Type":"application/json",
"body":JSON.stringify(data)
}
fetch(url,params);
console.log("firstmenusearch1 ok");
success2 = "o";
setTimeout(firstmenu2,2000);
}
function firstmenu2(){
if(request2 == "nomal"){
console.log("menusearch 通常処理　受付");
return;
}
console.log("firstmenu2 ok");
fetch('https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec',{
    method:"GET",
    moe:"cors"
  })
  .then(response =>{
    if(response.ok){
      return response.json()
    }
  })
  .then(resJson =>{
    console.log("firstmenusearch2 ok");
firstdata2 = resJson;
console.log("firstdata 1/2 finish");
console.log("wait for instructions");
success2 = "ok";
if(request2 == "next"){
console.log("menusearch2へ優先処理  in menu2")
menusearch2(resJson);
}
  })
.catch(error =>{
  num = 1;  
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("ss").innerHTML = "search";
document.getElementById("s").style.backgroundColor ="#5A3A1A";

alert("通信失敗2")
})
}
//ロード時に全データ取得のコード　終
shopname = '';
function searching(){
  num = 100;
  request3 = '';
  ani();
document.getElementById("ss").innerHTML = "loading";
document.getElementById("s").style.backgroundColor ="#C6AC8F"
  shopname = document.getElementById("search").value;
    if(success1 == "ok"){
    console.log("data:"+firstdata1)
shopsearch(firstdata1);
return;
  }
  if(success1 == "o"){
  console.log("途中からのリクエスト1");
  request1 = "next";
  return; //違う可能性大
}else{
  url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
var data = [{
"branch":"shopdata"
}]
var params={
"method":"post",
"mode":"no-cors",
"Content-Type":"application/json",
"body":JSON.stringify(data)
}
fetch(url,params);
setTimeout(searching2,3000);
}
}
function searching2(){
  fetch('https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec',{
    method:"GET",
    moe:"cors"
  })
  .then(response =>{
    if(response.ok){
      return response.json()
    }
  })
  .then(resJson =>{
    if(request2 == "next"){
      console.log("menusearch2への優先処理");
      menusearch2(resJson);
      
    }
shopsearch(resJson);
  })
.catch(error =>{
  num = 1;
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("ss").innerHTML = "search";
document.getElementById("s").style.backgroundColor ="#5A3A1A";

alert("通信失敗1")
})
}

function shopsearch(resJson){
  json = JSON.stringify(resJson);
json = JSON.parse(json);
a = "n1";
json = json.shopdata[0];
num = json.num+6;
for(a = -5; a<num; a+=6){
text = "n"+a;
shopname2 = json[text];
if(shopname == shopname2){
text2 = "searchnum="+a+"$";
shopname2 = encodeURI(shopname2);
text3 = "searchname="+shopname2+"^";
document.cookie = text2;
document.cookie = text3;
document.getElementById("ss").innerHTML = "jumping";
ttt = '';
document.cookie = "branch=shop|";
setTimeout(jump,1000);
return;
}
}
if(typeof ttt == 'undefined'){
/*alert("店舗を発見できません");
document.getElementById("ss").innerHTML = "search";
num = 1;
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("s").style.backgroundColor ="#5A3A1A";*/

if(success2 == "ok"){
console.log("data2:"+firstdata2);
menusearch2(firstdata2);
return;
}
if(success2 == "o"){
console.log("途中からのリクエスト2");
request2 = "next";
return;//間違えて可能性大
}else{
console.log("menusearch  通常処理")
request2 = "nomal";
menusearch();
}
}
}
function jump(){
num = 1;
  ani();
  document.getElementById("s").style.backgroundColor ="#5A3A1A";
if(typeof ttt == 'undefined'){
location.href="商品表示.html";
}else{
}
location.href="商品表示2.html";
}
function ani(){
//alert(num);
for(var a = 0; a<num; a++){
$("#ss").animate({
opacity:1
},{
'duration':0
})
$("#ss").animate({
opacity:0
},{
'duration':1000
})
$("#ss").animate({
opacity:1
},{
'duration':0
})
}
if(num == 1){
document.getElementById("ss").style.opacity = "1";
document.getElementById("s").style.backgroundColor ="#5A3A1A";
}
}
function menusearch(){
console.log("menusearch ok");
url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
var data = [{
"branch":"menu"
}]
var params={
"method":"post",
"mode":"no-cors",
"Content-Type":"application/json",
"body":JSON.stringify(data)
}
fetch(url,params);
setTimeout(menu2,3000);
}
function menu2(){
console.log("menu2 ok");
fetch('https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec',{
    method:"GET",
    moe:"cors"
  })
  .then(response =>{
    if(response.ok){
      return response.json()
    }
  })
  .then(resJson =>{
    console.log("menusearch2 ok");
menusearch2(resJson);
  })
.catch(error =>{
  num = 1;  
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("ss").innerHTML = "search";
document.getElementById("s").style.backgroundColor ="#5A3A1A";

alert("通信失敗2")
})
}


function menusearch2(resJson2){
if(request3 == "end"){
console.log("end")

}else{
jsonnn = JSON.stringify(resJson2);
console.log("JSON文字列↓");
console.log(jsonnn);
jsonn = JSON.parse(jsonnn);
console.log("JS文字列↓");
console.log(jsonn)
last = jsonn["last"];
console.log("last:"+last);
nummemo = [];
nummemo = [];
nummemo2 = [];
nummemo3 = 0;
for(var a = 1; a<=last; a+=6){
shopp  = String("shop"+a);
shoppi = "\""+shopp+"\""+":";
if(jsonnn.includes(shopp) === true){
menu = jsonn[shopp];
console.log(menu);
menulast = menu.length;
console.log(menulast);
}else{
console.log(shopp+":undefined");
}
for(var i = 0; i<menulast; i++){
menuname = menu[i];
if(menuname == shopname){
nummemo3++;
console.log(menuname+"発見");
i = String(i);
nummemo2.push(i);
console.log(nummemo2);
aa = 'ok';
}
}
if(typeof aa == 'string'){
nummemo2 = JSON.stringify(nummemo2);
console.log(nummemo2);
info = shoppi+nummemo2;
console.log(info);
nummemo.push(info);
nummemo2 = [];
aa = 0;
ss = String(a);
}
}
console.log(a)
if(a >= last && nummemo3 > 0){
console.log(nummemo);
nummemo = nummemo.toString().replace("\'","");
nummemo = "{"+nummemo+","+"\""+"last"+"\""+":"+"["+"\""+ss+"\""+"]"+"}";
console.log(nummemo);
console.log(nummemo3+":店舗発見")
num = 1;  
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("ss").innerHTML = "search";
document.getElementById("s").style.backgroundColor ="#5A3A1A";
cc = "menumemo="+nummemo+"-";
document.cookie = "branch=menu|";
document.cookie = cc;
document.getElementById("ss").innerHTML = "jumping";
jump();
}else{
ani();
$('#ss').clearQueue();
$('#ss').stop();
document.getElementById("ss").innerHTML = "search";
document.getElementById("s").style.backgroundColor ="#5A3A1A";
console.log("店舗・商品がありません");
alert("店舗・商品がありません");
/*if(request2 == "next"){
request3 = "end";
console.log("検索終了");
end();
}*/
if(success2 != "ok"){
request2 = '';
console.log("firstmenu  再トライ")
firstmenu();
}
request3 = "end";
console.log("検索終了");
end();
}
}
}
function end(){
console.log("検索 終了");
const flag = true;

try {

if (flag) {
 throw new Error('終了します');
}
console.log('実行されないコード');

} catch (e) {

console.log(e.message);

}
}
cartnum = 0;
function カート(){
  if(typeof cartt == 'undefined'){
    cookiedata1 = cart+cartnum+"=";
    cookiedata2 = sn2+"@>";
    cookiedata = cookiedata1+cookiedata2;
    cartt = "finish";
    document.getElementById("cart").style.backgroundColor = "orange";
    document.getElementById("cart").style.fontWeight = "600";
    document.getElementById("cart").innerHTML = "追加済み";
  }else{
alert("すでにカートに追加されています");
  }
}
