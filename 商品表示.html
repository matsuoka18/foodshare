<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>商品表示</title>
        <link rel="stylesheet" href="home1.css">
         
    </head>
    <body onload="start()">
   <div class="name2">
 <h1 id="h1"></h1>
<div class="name" onclick="location.href='index.html'">
<p class="namep">foodshare</p>
</div>

</div>
<section>
<div id="all"class="all">
  
</div>
</section>
  <div class="all2">
        <div class="bt1" onclick="back()">前の10個</div> 
        <div class="bt2" onclick="next()">次の10個</div> 
        </div>
 
        <script>
            function start(){
                cd= document.cookie;
                num1 = cd.indexOf("searchnum=");
                num2 = cd.indexOf("$");
                num3 = cd.indexOf("searchname=");
                num4 = cd.indexOf("%");
                sn = cd.substring(num1+10,num2);
                sn2 = cd.substring(num3+11,num4);
                console.log(sn+":"+sn2);
        document.getElementById("h1").innerHTML = sn2;
        url = "https://script.google.com/macros/s/AKfycbwBH_VrPaXcJg8HOXfoWHJY8f0Ir3935fqlJlURpyAkd8IdEQ/exec";
        data = [{
            "name4":"店舗商品取得",
            "name5":sn
        }];
        params={
            "method":"post",
            "mode":"no-cors",
            "Content-Type":"application/json",
            "body":JSON.stringify(data)
        }
        fetch(url,params);
        fetch(url,{ 
            method:"GET",
            mode:"cors"
        })
            .then(response =>{
                if(response.ok){
                    return response.json()
                }
            })
            .then(resJson =>{
                json = JSON.stringify(resJson);
                json = JSON.parse(json);
                console.log(json);
                number = 0;
                number2 = 10;
                show();
            })
           .catch(error =>{
               alert("エラー");
           })
       
            }
            function show(){
                sd = json.getmenudata[0];
                lm = sd.last;
                for(num = number; num<number2; num++){
                name = sd.name[num];
                fee = sd.fee[num]+"円";
                express = sd.express[num];
                genre = sd.genre[num];
                //pic = sd.name[num];
                 data =  "<div class="+"\""+"no1"+"\""+"><p class="+"\""+"shopname"+"\""+">"+sn2+"</p><div class="+"\""+"menufee"+"\""+"><p class="+"\""+"menu"+"\""+">"+name+"</p><p class="+"\""+"fee"+"\""+">"+fee+"</p></div><p class="+"\""+"express"+"\""+">"+express+"<div class="+"\""+"pic"+"\""+"></div></div>";
            all.insertAdjacentHTML('beforeend',data);

            }
            }
            function next(){
                number+=10;
                number2+=10;
                if(lm <number2){
                    number2 = lm;
               
                }
                if(lm <number){
                    number-=10;
                         alert("最後のページです");
                    return;
                }
                show();
            }
            function back(){
                number-=10;
                number2-=10;
                if(10 > number2){
                    number2 = 10;
               
                }
                if(0 > number){
                    number=0;
                         alert("最初のページです");
                    return;
                }
                show();
            }
            function test(){
                /*name = "potato";
                fee = "500";
                express = "this potato is the most delicious potato all over the world!! let's eat this!!"
                data =  "<div class="+"\""+"no1"+"\""+"><p class="+"\""+"shopname"+"\""+">"+sn2+"</p><div class="+"\""+"menufee"+"\""+"><p class="+"\""+"menu"+"\""+">"+name+"</p><p class="+"\""+"fee"+"\""+">"+fee+"</p></div><p class="+"\""+"express"+"\""+">"+express+"<div class="+"\""+"pic"+"\""+"></div></div>";
            all.insertAdjacentHTML('afterbegin',data)*/
                 
           
                
            }
        </script>
    </body>
 
</html>